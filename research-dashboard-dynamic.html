<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Research Dashboard</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
            CheckCircle, AlertTriangle, FileText, Beaker, Users, TrendingUp, 
            ChevronDown, ChevronUp, Activity, Target, Award, AlertCircle,
            Microscope, BookOpen, ShieldAlert, FlaskConical, XCircle
        } = lucide;

        // ============================================================================
        // CONFIGURATION: Change this to point to your JSON file
        // ============================================================================
        const JSON_FILE_PATH = './casp_evaluation.json';  // Change this path as needed
        // ============================================================================

        const Icon = ({ icon, className }) => {
            return React.createElement(icon, { 
                className, 
                size: className?.includes('w-3') ? 12 : 
                      className?.includes('w-4') ? 16 : 
                      className?.includes('w-8') ? 32 : 20 
            });
        };

        const ContextAwareDashboard = () => {
            const [activeTab, setActiveTab] = useState('overview');
            const [expandedCards, setExpandedCards] = useState({});
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [uploadMode, setUploadMode] = useState(true);

            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const rawData = JSON.parse(e.target.result);
                        const transformed = transformData(rawData);
                        setData(transformed);
                        setUploadMode(false);
                        setError(null);
                    } catch (err) {
                        setError(`Failed to parse JSON: ${err.message}`);
                    }
                };
                reader.readAsText(file);
            };

            const transformData = (rawData) => {
                const detectStudyType = (studyTypeString) => {
                    if (!studyTypeString) return 'ORIGINAL_ARTICLE';
                    const typeStr = studyTypeString.toLowerCase();
                    if (typeStr.includes('systematic review') || typeStr.includes('meta-analysis')) {
                        return 'SYSTEMATIC_REVIEW';
                    } else if (typeStr.includes('narrative review') || typeStr.includes('literature review')) {
                        return 'NARRATIVE_REVIEW';
                    }
                    return 'ORIGINAL_ARTICLE';
                };

                const studyType = detectStudyType(rawData.article_metadata?.study_type);
                const pico = rawData.casp_evaluation?.section_a_validity?.question_1_focused_issue?.details || {};

                const caspValidity = [];
                const caspResults = [];

                if (rawData.casp_evaluation?.section_a_validity) {
                    const validitySection = rawData.casp_evaluation.section_a_validity;
                    Object.keys(validitySection).forEach(key => {
                        if (key.startsWith('question_') && validitySection[key].question) {
                            const q = validitySection[key];
                            caspValidity.push({
                                question: q.question,
                                answer: q.answer,
                                score: q.score,
                                notes: q.notes,
                                concerns: q.concerns
                            });
                        }
                    });
                }

                if (rawData.casp_evaluation?.section_b_results) {
                    const resultsSection = rawData.casp_evaluation.section_b_results;
                    Object.keys(resultsSection).forEach(key => {
                        if (key.startsWith('question_') && resultsSection[key].question) {
                            const q = resultsSection[key];
                            caspResults.push({
                                question: q.question,
                                answer: q.answer,
                                score: q.score,
                                notes: q.notes,
                                concerns: q.concerns,
                                biasRisk: q.bias_risk
                            });
                        }
                    });
                }

                const missingOutcomes = [];
                if (rawData.casp_evaluation?.section_b_results?.question_10_outcomes?.outcomes_missing) {
                    const missing = rawData.casp_evaluation.section_b_results.question_10_outcomes.outcomes_missing;
                    missingOutcomes.push({
                        category: 'Missing Clinical Outcomes',
                        gaps: missing,
                        criticalityLevel: 'HIGH'
                    });
                }

                const scientificJustification = {
                    gradeRationale: rawData.overall_assessment?.reliability_conclusion || 
                                    'Evidence quality assessment based on study design, risk of bias, and applicability.',
                    keyDowngrades: [],
                    upgradeConsiderations: []
                };

                if (rawData.additional_quality_assessment?.internal_validity) {
                    const validity = rawData.additional_quality_assessment.internal_validity;
                    Object.keys(validity).forEach(biasType => {
                        if (biasType !== 'limitations_found' && validity[biasType].risk) {
                            const risk = validity[biasType].risk;
                            if (risk === 'HIGH' || risk === 'MODERATE') {
                                scientificJustification.keyDowngrades.push({
                                    factor: biasType.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
                                    impact: risk === 'HIGH' ? 'Major downgrade' : 'Moderate downgrade',
                                    explanation: validity[biasType].notes || 'See study assessment for details.'
                                });
                            }
                        }
                    });
                }

                const sampleSizeNote = rawData.additional_quality_assessment?.statistical_rigor?.sample_size_justification;
                if (sampleSizeNote && (sampleSizeNote.includes('N=7') || sampleSizeNote.includes('small'))) {
                    scientificJustification.keyDowngrades.push({
                        factor: 'Small Human Sample Size (N=7)',
                        impact: 'Major downgrade',
                        explanation: sampleSizeNote
                    });
                }

                if (rawData.additional_quality_assessment?.mechanistic_strength?.causality_evidence) {
                    const evidence = rawData.additional_quality_assessment.mechanistic_strength.causality_evidence;
                    if (Array.isArray(evidence) && evidence.length > 0) {
                        scientificJustification.upgradeConsiderations.push({
                            factor: 'Strong Mechanistic Evidence',
                            rationale: evidence.slice(0, 2).join(' ')
                        });
                    }
                }

                return {
                    metadata: {
                        title: rawData.article_metadata?.title || 'Study Title Not Available',
                        authors: rawData.article_metadata?.authors || [],
                        journal: rawData.article_metadata?.journal || 'Journal Not Specified',
                        year: rawData.article_metadata?.publication_year || '',
                        doi: rawData.article_metadata?.doi || '',
                        studyType: studyType,
                        studyTypeLabel: rawData.article_metadata?.study_type || 'Study Type Not Specified'
                    },
                    quality: {
                        score: rawData.overall_assessment?.percentage_score || 0,
                        rating: rawData.overall_assessment?.quality_rating || 'NOT ASSESSED',
                        totalQuestions: rawData.overall_assessment?.total_applicable_questions || 0,
                        totalScore: rawData.overall_assessment?.total_score || 0
                    },
                    pico: {
                        population: pico.population || 'Not specified',
                        intervention: pico.intervention || 'Not specified',
                        comparator: pico.comparator || 'Not specified',
                        outcomes: pico.outcomes || 'Not specified'
                    },
                    casp: {
                        validity: caspValidity,
                        results: caspResults
                    },
                    strengths: rawData.overall_assessment?.key_strengths || [],
                    limitations: rawData.overall_assessment?.key_limitations || [],
                    conclusion: rawData.overall_assessment?.reliability_conclusion || 'Conclusion not available.',
                    scientificJustification: scientificJustification,
                    missingOutcomes: missingOutcomes
                };
            };

            const studyTypeConfig = {
                ORIGINAL_ARTICLE: {
                    bgColor: 'bg-blue-50',
                    borderColor: 'border-blue-300',
                    textColor: 'text-blue-900',
                    accentColor: 'text-blue-600'
                },
                SYSTEMATIC_REVIEW: {
                    bgColor: 'bg-purple-50',
                    borderColor: 'border-purple-300',
                    textColor: 'text-purple-900',
                    accentColor: 'text-purple-600'
                },
                NARRATIVE_REVIEW: {
                    bgColor: 'bg-teal-50',
                    borderColor: 'border-teal-300',
                    textColor: 'text-teal-900',
                    accentColor: 'text-teal-600'
                }
            };

            const tabConfigs = {
                ORIGINAL_ARTICLE: [
                    { id: 'overview', label: 'Overview', icon: Award },
                    { id: 'pico', label: 'PICO Framework', icon: Users },
                    { id: 'casp', label: 'CASP Quality', icon: Beaker },
                    { id: 'grade', label: 'GRADE Evidence', icon: FileText },
                    { id: 'missing', label: 'Gap Analysis', icon: AlertCircle }
                ],
                SYSTEMATIC_REVIEW: [
                    { id: 'overview', label: 'Overview', icon: Award },
                    { id: 'pico', label: 'PICO Framework', icon: Users },
                    { id: 'prisma', label: 'PRISMA/AMSTAR', icon: BookOpen },
                    { id: 'grade', label: 'GRADE Evidence', icon: FileText },
                    { id: 'missing', label: 'Gap Analysis', icon: AlertCircle }
                ],
                NARRATIVE_REVIEW: [
                    { id: 'overview', label: 'Overview', icon: Award },
                    { id: 'scope', label: 'Scope (PICO)', icon: Users },
                    { id: 'sanra', label: 'SANRA Analysis', icon: Microscope },
                    { id: 'evidence', label: 'Evidence Quality', icon: FileText },
                    { id: 'missing', label: 'Gap Analysis', icon: AlertCircle }
                ]
            };

            const toggleCard = (id) => {
                setExpandedCards(prev => ({ ...prev, [id]: !prev[id] }));
            };

            const getQualityColor = (rating) => {
                const upperRating = (rating || '').toUpperCase();
                switch(upperRating) {
                    case 'HIGH': return 'text-green-600 bg-green-50 border-green-200';
                    case 'MODERATE': return 'text-orange-600 bg-orange-50 border-orange-200';
                    case 'LOW': return 'text-red-600 bg-red-50 border-red-200';
                    default: return 'text-gray-600 bg-gray-50 border-gray-200';
                }
            };

            const getCriticalityColor = (level) => {
                const upperLevel = (level || '').toUpperCase();
                switch(upperLevel) {
                    case 'HIGH': return 'border-red-300 bg-red-50 text-red-900';
                    case 'MODERATE': return 'border-orange-300 bg-orange-50 text-orange-900';
                    case 'LOW': return 'border-yellow-300 bg-yellow-50 text-yellow-900';
                    default: return 'border-gray-300 bg-gray-50 text-gray-900';
                }
            };

            const getAnswerBadge = (answer) => {
                const upperAnswer = (answer || '').toUpperCase();
                const colors = {
                    'YES': 'bg-green-100 text-green-800 border-green-300',
                    'PARTIAL': 'bg-yellow-100 text-yellow-800 border-yellow-300',
                    'NO': 'bg-red-100 text-red-800 border-red-300'
                };
                return colors[upperAnswer] || 'bg-gray-100 text-gray-800 border-gray-300';
            };

            const CircularProgress = ({ percentage, size = 140 }) => {
                const radius = (size - 20) / 2;
                const circumference = 2 * Math.PI * radius;
                const offset = circumference - (percentage / 100) * circumference;
                const color = percentage >= 75 ? '#16a34a' : percentage >= 50 ? '#ea580c' : '#dc2626';

                return (
                    <div className="relative inline-flex items-center justify-center">
                        <svg width={size} height={size} className="transform -rotate-90">
                            <circle cx={size / 2} cy={size / 2} r={radius} stroke="#e5e7eb" strokeWidth="10" fill="none" />
                            <circle cx={size / 2} cy={size / 2} r={radius} stroke={color} strokeWidth="10" fill="none"
                                strokeDasharray={circumference} strokeDashoffset={offset} strokeLinecap="round"
                                className="transition-all duration-1000 ease-out" />
                        </svg>
                        <div className="absolute inset-0 flex flex-col items-center justify-center">
                            <span className="text-3xl font-bold" style={{ color }}>{percentage}%</span>
                            <span className="text-xs text-gray-500 uppercase tracking-wide">Quality</span>
                        </div>
                    </div>
                );
            };

            const ExpandableCard = ({ id, title, icon, children, variant = 'default' }) => {
                const isExpanded = expandedCards[id];
                const colors = {
                    strength: 'border-green-200 bg-green-50',
                    limitation: 'border-red-200 bg-red-50',
                    default: 'border-gray-200 bg-white'
                };

                return (
                    <div className={`border rounded-lg ${colors[variant]} transition-all duration-200`}>
                        <button onClick={() => toggleCard(id)}
                            className="w-full px-4 py-3 flex items-center justify-between hover:bg-opacity-80 transition-colors">
                            <div className="flex items-center gap-3">
                                <Icon icon={icon} className="w-5 h-5" />
                                <span className="font-medium text-sm">{title}</span>
                            </div>
                            <Icon icon={isExpanded ? ChevronUp : ChevronDown} className="w-4 h-4" />
                        </button>
                        {isExpanded && (
                            <div className="px-4 pb-4 pt-1 text-sm text-gray-700 leading-relaxed border-t border-gray-200">
                                {children}
                            </div>
                        )}
                    </div>
                );
            };

            if (uploadMode || !data) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                            <div className="text-center mb-6">
                                <div className="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
                                    <Icon icon={FileText} className="w-8 h-8 text-blue-600" />
                                </div>
                                <h2 className="text-2xl font-bold text-gray-900 mb-2">Research Dashboard</h2>
                                <p className="text-gray-600">Upload your JSON analysis file to visualize results</p>
                            </div>
                            
                            <div className="space-y-4">
                                <label className="block">
                                    <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 hover:bg-blue-50 transition-all cursor-pointer">
                                        <Icon icon={Award} className="w-12 h-12 text-gray-400 mx-auto mb-3" />
                                        <span className="text-sm font-medium text-gray-700">
                                            Click to upload JSON file
                                        </span>
                                        <p className="text-xs text-gray-500 mt-1">
                                            From Streamlit app download
                                        </p>
                                    </div>
                                    <input 
                                        type="file" 
                                        accept=".json"
                                        onChange={handleFileUpload}
                                        className="hidden"
                                    />
                                </label>
                                
                                {error && (
                                    <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                                        <div className="flex items-start gap-2">
                                            <Icon icon={AlertTriangle} className="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" />
                                            <div>
                                                <p className="text-sm font-semibold text-red-900">Upload Error</p>
                                                <p className="text-xs text-red-700 mt-1">{error}</p>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                            
                            <div className="mt-6 pt-6 border-t border-gray-200">
                                <p className="text-xs text-gray-500 text-center">
                                    ðŸ’¡ Download JSON from Streamlit app after analysis
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }

            if (loading) {
                return (
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"></div>
                            <p className="text-gray-600">Loading research data...</p>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                        <div className="bg-red-50 border-2 border-red-300 rounded-lg p-6 max-w-md">
                            <div className="flex items-start gap-3">
                                <Icon icon={AlertTriangle} className="w-6 h-6 text-red-600 flex-shrink-0 mt-1" />
                                <div>
                                    <h3 className="font-bold text-red-900 mb-2">Error Loading Data</h3>
                                    <p className="text-sm text-red-800">{error}</p>
                                    <p className="text-xs text-red-700 mt-3">
                                        Make sure <code className="bg-red-100 px-1 rounded">{JSON_FILE_PATH}</code> is in the correct location.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (!data) return null;

            const currentTheme = studyTypeConfig[data.metadata.studyType];
            const tabs = tabConfigs[data.metadata.studyType];

            // Tab Components (simplified versions for brevity - implement as needed)
            const OverviewTab = () => (
                <div className="space-y-6">
                    <div className="bg-white border border-gray-200 rounded-lg p-6">
                        <div className="flex items-start gap-3 mb-3 flex-wrap">
                            <h2 className="text-2xl font-bold text-gray-900 flex-1">{data.metadata.title}</h2>
                            <div className={`px-4 py-2 rounded-lg border-2 ${currentTheme.bgColor} ${currentTheme.borderColor}`}>
                                <div className="flex items-center gap-2">
                                    <Icon icon={FlaskConical} className={`w-5 h-5 ${currentTheme.accentColor}`} />
                                    <div>
                                        <div className="text-xs text-gray-600 uppercase">Study Type</div>
                                        <div className={`text-sm font-bold ${currentTheme.textColor}`}>{data.metadata.studyTypeLabel}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white border border-gray-200 rounded-lg p-6">
                        <div className="flex flex-col md:flex-row items-center justify-between gap-6">
                            <div className="flex-1">
                                <h3 className="text-lg font-semibold text-gray-900 mb-2 flex items-center gap-2">
                                    <Icon icon={Award} className="w-5 h-5 text-orange-600" />
                                    Overall Quality Assessment
                                </h3>
                                <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-full border-2 ${getQualityColor(data.quality.rating)}`}>
                                    <span className="text-sm font-bold uppercase">{data.quality.rating} Quality</span>
                                </div>
                                <p className="mt-4 text-sm text-gray-600">
                                    CASP Score: {data.quality.totalScore} / {data.quality.totalQuestions}
                                </p>
                            </div>
                            <CircularProgress percentage={data.quality.score} />
                        </div>
                    </div>

                    {data.scientificJustification && (
                        <div className="bg-gradient-to-br from-indigo-50 to-blue-50 border-2 border-indigo-200 rounded-lg p-6">
                            <h3 className="text-lg font-semibold text-indigo-900 mb-4 flex items-center gap-2">
                                <Icon icon={Microscope} className="w-5 h-5 text-indigo-600" />
                                Scientific Logic & Justification
                            </h3>
                            <div className="bg-white rounded-lg p-4 border border-indigo-100 mb-4">
                                <h4 className="font-semibold text-sm text-indigo-800 mb-2">
                                    Why {data.quality.rating} Quality ({data.quality.score}%)?
                                </h4>
                                <p className="text-sm text-gray-700 leading-relaxed">{data.scientificJustification.gradeRationale}</p>
                            </div>
                            
                            {data.scientificJustification.keyDowngrades?.length > 0 && (
                                <div className="space-y-2">
                                    <h4 className="font-semibold text-sm text-red-800 mb-2 flex items-center gap-2">
                                        <Icon icon={AlertTriangle} className="w-4 h-4" />
                                        Key Downgrades
                                    </h4>
                                    {data.scientificJustification.keyDowngrades.map((item, idx) => (
                                        <div key={idx} className="bg-white rounded-lg p-3 border-l-4 border-red-400">
                                            <div className="flex justify-between mb-1">
                                                <span className="font-semibold text-sm">{item.factor}</span>
                                                <span className="text-xs px-2 py-1 bg-red-100 text-red-800 rounded-full">{item.impact}</span>
                                            </div>
                                            <p className="text-xs text-gray-600">{item.explanation}</p>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );

            const PICOTab = () => (
                <div className="bg-white border border-gray-200 rounded-lg p-6">
                    <h3 className="text-lg font-semibold mb-4 flex items-center gap-2">
                        <Icon icon={Users} className="w-5 h-5 text-blue-600" />
                        PICO Framework
                    </h3>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        <div className="border border-blue-200 rounded-lg p-4 bg-blue-50">
                            <h4 className="font-semibold text-sm text-blue-900 mb-2">Population</h4>
                            <p className="text-sm text-gray-700">{data.pico.population}</p>
                        </div>
                        <div className="border border-green-200 rounded-lg p-4 bg-green-50">
                            <h4 className="font-semibold text-sm text-green-900 mb-2">Intervention</h4>
                            <p className="text-sm text-gray-700">{data.pico.intervention}</p>
                        </div>
                        <div className="border border-purple-200 rounded-lg p-4 bg-purple-50">
                            <h4 className="font-semibold text-sm text-purple-900 mb-2">Comparator</h4>
                            <p className="text-sm text-gray-700">{data.pico.comparator}</p>
                        </div>
                        <div className="border border-orange-200 rounded-lg p-4 bg-orange-50">
                            <h4 className="font-semibold text-sm text-orange-900 mb-2">Outcomes</h4>
                            <p className="text-sm text-gray-700">{data.pico.outcomes}</p>
                        </div>
                    </div>
                </div>
            );

            const CASPTab = () => (
                <div className="bg-white border border-gray-200 rounded-lg p-6">
                    <h3 className="text-lg font-semibold mb-4 flex items-center gap-2">
                        <Icon icon={Beaker} className="w-5 h-5 text-purple-600" />
                        CASP Assessment
                    </h3>
                    {data.casp.validity?.length > 0 && (
                        <div className="space-y-3">
                            {data.casp.validity.concat(data.casp.results).map((item, idx) => (
                                <div key={idx} className="border rounded-lg p-4">
                                    <div className="flex justify-between mb-2">
                                        <p className="text-sm font-medium flex-1">{item.question}</p>
                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getAnswerBadge(item.answer)}`}>
                                            {item.answer}
                                        </span>
                                    </div>
                                    {item.notes && <p className="text-xs text-gray-600 bg-gray-50 p-2 rounded">{item.notes}</p>}
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );

            const GRADETab = () => (
                <div className="bg-white border border-gray-200 rounded-lg p-6">
                    <h3 className="text-lg font-semibold mb-4 flex items-center gap-2">
                        <Icon icon={FileText} className="w-5 h-5 text-indigo-600" />
                        GRADE Evidence
                    </h3>
                    <div className="p-4 bg-orange-50 border border-orange-200 rounded-lg mb-6">
                        <p className="text-sm text-gray-700">{data.conclusion}</p>
                    </div>
                    {data.strengths?.length > 0 && data.strengths.map((s, i) => (
                        <ExpandableCard key={i} id={`str-${i}`} title={`Strength ${i+1}`} icon={CheckCircle} variant="strength">{s}</ExpandableCard>
                    ))}
                    {data.limitations?.length > 0 && data.limitations.map((l, i) => (
                        <ExpandableCard key={i} id={`lim-${i}`} title={l.includes('N=7') ? 'Critical: N=7' : `Limitation ${i+1}`} icon={AlertTriangle} variant="limitation">{l}</ExpandableCard>
                    ))}
                </div>
            );

            const MissingTab = () => (
                <div className="space-y-6">
                    <div className="bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-300 rounded-lg p-6">
                        <div className="flex gap-4">
                            <Icon icon={ShieldAlert} className="w-8 h-8 text-red-600 mt-1" />
                            <div>
                                <h3 className="text-xl font-bold text-red-900 mb-2">Evidence Gaps</h3>
                                <p className="text-sm text-red-800">Missing outcomes and populations.</p>
                            </div>
                        </div>
                    </div>
                    {data.missingOutcomes?.length > 0 ? (
                        data.missingOutcomes.map((cat, i) => (
                            <div key={i} className={`border-2 rounded-lg p-6 ${getCriticalityColor(cat.criticalityLevel)}`}>
                                <h4 className="text-lg font-bold mb-4">{cat.category}</h4>
                                <ul className="space-y-2">
                                    {cat.gaps.map((gap, j) => (
                                        <li key={j} className="flex gap-3 text-sm">
                                            <Icon icon={AlertTriangle} className="w-4 h-4 mt-0.5" />
                                            <span>{gap}</span>
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        ))
                    ) : (
                        <div className="bg-gray-50 border rounded-lg p-6 text-center">
                            <p className="text-gray-600">No gaps documented</p>
                        </div>
                    )}
                </div>
            );

            return (
                <div className="min-h-screen bg-gray-50 p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="mb-8 flex items-center justify-between">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-900 mb-2">Research Analysis Dashboard</h1>
                                <p className="text-gray-600">Context-Aware Quality Assessment</p>
                            </div>
                            <button 
                                onClick={() => setUploadMode(true)}
                                className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                            >
                                <Icon icon={FileText} className="w-4 h-4" />
                                Load New File
                            </button>
                        </div>

                        <div className="bg-white border rounded-lg mb-6 overflow-hidden">
                            <div className="flex flex-wrap border-b">
                                {tabs.map(tab => (
                                    <button key={tab.id} onClick={() => setActiveTab(tab.id)}
                                        className={`flex items-center gap-2 px-6 py-4 font-medium text-sm transition-all ${
                                            activeTab === tab.id
                                                ? `${currentTheme.bgColor} ${currentTheme.accentColor} border-b-2 ${currentTheme.borderColor}`
                                                : 'text-gray-600 hover:bg-gray-50'
                                        }`}>
                                        <Icon icon={tab.icon} className="w-4 h-4" />
                                        {tab.label}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div>
                            {activeTab === 'overview' && <OverviewTab />}
                            {(activeTab === 'pico' || activeTab === 'scope') && <PICOTab />}
                            {(activeTab === 'casp' || activeTab === 'prisma' || activeTab === 'sanra') && <CASPTab />}
                            {(activeTab === 'grade' || activeTab === 'evidence') && <GRADETab />}
                            {activeTab === 'missing' && <MissingTab />}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ContextAwareDashboard />);
    </script>
</body>
</html>
